<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout</title>

<style>
body{
margin:0;
font-family:Arial;
background:#000;
color:white;
padding:15px;
}

h2{text-align:center;}

.box{
background:#111;
padding:15px;
border-radius:14px;
margin:12px 0;
box-shadow:0 0 15px rgba(0,150,255,0.2);
border:1px solid #1f1f1f;
}

.total{
color:#00e5ff;
font-weight:bold;
text-align:right;
font-size:18px;
}

.bank-card{
background:#0f0f0f;
padding:25px;
margin:20px 0;
border-radius:20px;
border:1px solid #00c3ff;
box-shadow:0 0 15px rgba(0,195,255,0.4);
}

button{
width:100%;
padding:14px;
margin-top:15px;
border:none;
border-radius:12px;
font-size:16px;
font-weight:bold;
cursor:pointer;
background:linear-gradient(90deg,#00c6ff,#0072ff);
color:white;
}

#contactBtn{
display:none;
background:linear-gradient(90deg,#25D366,#128C7E);
}

input{
width:100%;
padding:12px;
margin-top:8px;
border-radius:10px;
border:none;
background:#1a1a1a;
color:white;
}

.warning{
color:#ff3b3b;
font-size:13px;
text-align:center;
margin-top:8px;
}

/* SUCCESS POPUP */

#successBox{
display:none;
position:fixed;
top:50%;
left:50%;
transform:translate(-50%,-50%);
background:#111;
padding:25px;
border-radius:15px;
border:1px solid #00ff99;
box-shadow:0 0 25px rgba(0,255,150,0.6);
text-align:center;
z-index:999;
}

#successBox h3{
color:#00ff99;
margin-bottom:10px;
}

</style>
</head>
<body>

<h2>PAYMENT DETAIL</h2>

<div id="summary"></div>
<div class="box total" id="total"></div>

<!-- BANK DETAILS -->

<div class="box">
üè¶ <b>COMMERCIAL BANK</b><br>
Acc No: 8028325273<br>
Name: K B DULANI<br>
Branch: BANDARAWELA
</div>

<div class="box">
üè¶ <b>DIALOG FINANCE BANK</b><br>
Acc No: 001022035261<br>
Name: M M R I HANSAKA<br>
Branch: HEAD OFFICE
</div>

<div class="box">
üè¶ <b>HNB BANK</b><br>
Acc No: 012020083286<br>
Name: ASANKA M M I S<br>
Branch: BANDARAWELA
</div>

<div class="bank-card">
<h3>üè¶ EZ CASH</h3>
<p><strong>EZ No:</strong> 0768571751</p>
</div>

<div class="box">

Player Name
<input type="text" id="playerName" placeholder="Enter Player Name">

Player ID
<input type="text" id="playerId" placeholder="Enter Player ID">

WhatsApp Number
<input type="text" id="whatsapp" placeholder="Enter WhatsApp Number">

<br><br>
üì§ Upload Transfer Receipt
<input type="file" id="receipt" accept="image/*">

<button onclick="sendToTelegram()">ORDER SENDING</button>

<div class="warning">
EZ Cash ‡∂ú‡∑ô‡∑Ä‡∑ì‡∂∏‡∑ö‡∂Ø‡∑ì ‡∂ª‡∑î.20 ‡∑Ä‡∑ê‡∂©‡∑í‡∂∫‡∑ô‡∂±‡∑ä ‡∂Ø‡∑ê‡∂∏‡∑ì‡∂∏ ‡∂Ö‡∂±‡∑í‡∑Ä‡∑è‡∂ª‡∂∫ ‡∑Ä‡∑ö.
</div>

<button id="contactBtn" onclick="contactAdmin()">CONTACT ADMIN</button>

</div>

<!-- SUCCESS POPUP -->
<div id="successBox">
<h3>‚úÖ Order Sent Successfully!</h3>
<p>Your Order ID:</p>
<p id="orderDisplay" style="font-weight:bold;"></p>
</div>

<script>

let cart = JSON.parse(localStorage.getItem("cart"))||{};
let items = JSON.parse(localStorage.getItem("items"))||[];
let summary=document.getElementById("summary");
let total=0;

for(let i in cart){
if(cart[i]>0){
let line=document.createElement("div");
line.className="box";
line.innerHTML=items[i][0]+" x "+cart[i]+" ‚Äî "+(items[i][1]*cart[i])+" LKR";
summary.appendChild(line);
total+=items[i][1]*cart[i];
}
}

document.getElementById("total").innerText="TOTAL: "+total+" LKR";

let lastOrderId="";
let adminNumber="94773847598"; // CHANGE ADMIN NUMBER

async function sendToTelegram(){

let name=document.getElementById("playerName").value;
let id=document.getElementById("playerId").value;
let wp=document.getElementById("whatsapp").value;
let receipt=document.getElementById("receipt");

if(name==""||id==""||wp==""){
alert("Fill all fields!");
return;
}

if(receipt.files.length==0){
alert("Upload receipt!");
return;
}

let orderId="ORD"+Date.now();
lastOrderId=orderId;

let message=
"üõí NEW ORDER\n\n"+
"üÜî Order ID: "+orderId+"\n"+
"üë§ Name: "+name+"\n"+
"üéÆ Player ID: "+id+"\n"+
"üì≤ Customer WhatsApp: https://wa.me/"+wp+"\n\n";

for(let i in cart){
if(cart[i]>0){
message+=items[i][0]+" x "+cart[i]+" = "+(items[i][1]*cart[i])+" LKR\n";
}
}

message+="\nüí∞ Total: "+total+" LKR (+20 EZ Fee)";

let botToken="8543584838:AAGFGgn20yzXsmS1bAjp3BIB0eCZW0NvVs0";
let chatId="8324590734";

let formData=new FormData();
formData.append("chat_id",chatId);
formData.append("caption",message);
formData.append("photo",receipt.files[0]);

await fetch("https://api.telegram.org/bot"+botToken+"/sendPhoto",{
method:"POST",
body:formData
});

// Show nice popup instead of alert
document.getElementById("orderDisplay").innerText=orderId;
document.getElementById("successBox").style.display="block";

// Hide popup after 3 sec
setTimeout(()=>{
document.getElementById("successBox").style.display="none";
},3000);

// Show Contact Admin button
document.getElementById("contactBtn").style.display="block";
}

function contactAdmin(){

let name=document.getElementById("playerName").value;
let id=document.getElementById("playerId").value;
let wp=document.getElementById("whatsapp").value;

let fullMessage =
"üõí *ORDER CONFIRMATION*\n\n"+
"üÜî Order ID: "+lastOrderId+"\n"+
"üë§ Name: "+name+"\n"+
"üéÆ Player ID: "+id+"\n"+
"üì≤ Customer WhatsApp: "+wp+"\n\n";

for(let i in cart){
if(cart[i]>0){
fullMessage+=items[i][0]+" x "+cart[i]+" = "+(items[i][1]*cart[i])+" LKR\n";
}
}

fullMessage+="\nüí∞ Total: "+total+" LKR (+20 EZ Fee)";

// Auto copy Order ID
navigator.clipboard.writeText(lastOrderId);

// Open WhatsApp with full order
window.open(
"https://wa.me/"+adminNumber+"?text="+encodeURIComponent(fullMessage),
"_blank"
);

}

</script>

</body>
</html>
